@page "/users/details"
@attribute [Authorize(Roles = "Admin,Lecture,Lecturer")]
@using Microsoft.AspNetCore.Identity
@using Microsoft.EntityFrameworkCore
@using FinalAssignemnt_APDP.Data
@inject UserManager<ApplicationUser> UserManager
@inject NavigationManager NavigationManager

<PageTitle>User Details</PageTitle>

@if (User is null)
{
	<p class="text-slate-500">Loadingâ€¦</p>
}
else
{
	<div class="max-w-2xl space-y-6">
		<div class="flex items-center gap-4">
			<a href="/users" class="inline-flex items-center rounded-full border border-slate-200 px-3 py-1 text-sm font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-900">Back</a>
			<div>
				<h1 class="text-2xl font-semibold text-slate-900">User details</h1>
				<p class="text-sm text-slate-500">Review the profile information.</p>
			</div>
		</div>

		<div class="rounded-2xl bg-white p-6 shadow-sm">
			<dl class="divide-y divide-slate-100 text-sm">
				<div class="grid grid-cols-3 gap-4 py-3">
					<dt class="font-medium text-slate-500">Email</dt>
					<dd class="col-span-2 font-mono text-slate-900">@User.Email</dd>
				</div>
				<div class="grid grid-cols-3 gap-4 py-3">
					<dt class="font-medium text-slate-500">Name</dt>
					<dd class="col-span-2 text-slate-900">@User.Name</dd>
				</div>
				<div class="grid grid-cols-3 gap-4 py-3">
					<dt class="font-medium text-slate-500">Student ID</dt>
					<dd class="col-span-2 font-mono text-slate-900">@User.StudentId</dd>
				</div>
				<div class="grid grid-cols-3 gap-4 py-3">
					<dt class="font-medium text-slate-500">Roles</dt>
					<dd class="col-span-2 text-slate-900">@RolesStr</dd>
				</div>
			</dl>
		</div>
	</div>
}

@code {
 [SupplyParameterFromQuery]
 public string Id { get; set; } = "";
 private ApplicationUser? User { get; set; }
 private string RolesStr { get; set; } = "";
 protected override async Task OnInitializedAsync()
 {
 if (!string.IsNullOrEmpty(Id))
 {
 User = await UserManager.FindByIdAsync(Id);
 if (User is null) { NavigationManager.NavigateTo("notfound"); return; }
 var roles = await UserManager.GetRolesAsync(User);
 RolesStr = string.Join(", ", roles);
 }
 }
}
